sudo: false
os: linux
language: haskell
addons:
  apt:
    packages:
    - texlive-latex-recommended lmodern texlive-fonts-recommended texlive-latex-extra
      texlive-fonts-extra dvipng texlive-latex-recommended texlive-lang-french
before_install:
- sudo add-apt-repository -y ppa:jonathonf/python-2.7
- sudo apt-get update
- sudo apt-get install python2.7  librsvg2-bin
install:
- wget https://github.com/jgm/pandoc/releases/download/2.0.6/pandoc-2.0.6-1-amd64.deb
- sudo dpkg -i pandoc-2.0.6-1-amd64.deb
- wget https://github.com/lierdakil/pandoc-crossref/releases/download/v0.3.0.1/linux-ghc80-pandoc20.tar.gz
- mkdir pandoc-crossref
- cd pandoc-crossref
- mv ../linux-ghc80-pandoc20.tar.gz .
- tar xzvf linux-ghc80-pandoc20.tar.gz
- cd ..
- export PATH=`pwd`/pandoc-crossref:$PATH
- sudo -H pip install --upgrade pip
- sudo -H pip install -U pandoc-numbering
cache:
- pip
script:
- make
after_deploy: |
  git config --global user.email "travis@travis-ci.org"
  git config --global user.name "Travis CI"
  cd "$TRAVIS_BUILD_DIR"
  git clone https://${GH_TOKEN}@github.com/mathintro/mathintro.github.io.git
  cd mathintro.github.io
  # This generates a `web` directory containing the website.
  cp ../cours.html deuxieme_logiciel/index.html
  git add deuxieme_logiciel/index.html
  git commit --message "Travis build: $TRAVIS_BUILD_NUMBER"
  # Make sure to make the output quiet, or else the API token will leak!
  # This works because the API key can replace your password.
  git push --quiet https://${GH_TOKEN}@github.com/mathintro/mathintro.github.io.git
env:
  global:
  - secure: T+lWrUykK/tMback4XHqqsBS8y+oInXNjeEzeXmSgy9hpdIYI/IPI245MOvVM1GqWzyaxtNzyciHu2eUMdu4G0VJzlgwqIjrM3glpk51NIpTOBMJqoMamFEyGb1oUfhqEtKw8EUNHmHlpil0T9Y4X01U1S2dcPTCsJMbHZZUP3FaO2O1NXznO+1idGyK5OyR3SahA3f4AXyiNSAWhBl6Hn7vx99k1y/oK4c192aqHtq0WfwQyOHOOEls+MHQ/czHaB5Y5R04Z3pq7f8+5YvZtMICZN4kcQYeDou4a1FssLBPKupDQSryVPR4EzddqxEoJQWT+hq5CwWINAf1BHJnWs8lBgDWoA0Rs3Qd9aSmMm93mssWX8lCzy+VBH1zSEUul2xY++hvDQRmIkA2MplKilNPD6fFJBZIqYEH/Vltd7gPWD0hE3aRrgC/7cffpnmQGMcaHWIAG4r++qxlaiIAxcs2SyJOEPzB72qOtNGqYqgwpeBcwZF8r+R7etmE/4sl5aQzJlrohe6YmHM5ue/P0Co9iE9DeLBE90c5CcHbcr/K/U6Ei5FybWAGamNY6iKtQp6v6OGtgswNI9+DPatGF9dkfiEmGDZaPGRUsrGd0uPOoZnh4XzXxbo1UgCOe1MeYPZAbpgzsdkjGnNs5boPoQ0h2975h4Ja8CsYnRGadgI=
deploy:
  provider: releases
  api_key:
    secure: AkCySQ1MdLrN/2y8PsKmxpG2IyiS7d8X/i49S6LUNTgkQwoSR2Rwicql+KsMUSRxRoVt7KXb5S96J2jFO4Yhpyk0MdyrN08HicKpbmw3n0LKi9yXHC2CLu4bB59OXJ6xFYm7SVuq3rSd6EwOwzSd/qhYWYCMZMwPwN0yqHNr6fqWPFMtQd07QtZJD7XSlLbegYu7KPp/4mmJU+/3BBQcLz8ZsyFQpuO9R6LuS8K68TFXzdOrm3TmLVoYpfB5rtONNzmAZ9PMdlnsqeVc0RtCFBtK3qn7GJNAY2PRbx8WAWiTq/1oSJvVhld08/X2Y9IS77rdXH4EgOJQYtvT1HKkpM3jQ8kgJYtXCGwwyvoqWN9f6pF0vmBMNeGBFNjNEQncC634bPBwHKvmC7QouDmU3JnaVZesCOyVevEvfB4HSUdNUcIi1Hf27EmM4hHIgxrAst7nk/bjIisBK9ZCLOWH+OBGqGVgGDfOpjCVGWsltVOQ8CSpmvmJ/Vl4OCE3VL8sVbJIwK5rGLHvZeuWkz0czAmdLoGjqkEQ8SPT7Ef2HzF7snkfLQnDirsO9HtGAPar8I6UMmruZMukJDLOj92VtRS/d+4K70Jmg4zJpKtFO4NulwGOtbaU23GyZOzLZOkcsD+4dL1wFRlzPEHfxnfzi/QCFLuyrTzD9g5marzSxbo=
  file: cours.html cours.pdf
  on:
    repo: mathintro/deuxieme_logiciel
