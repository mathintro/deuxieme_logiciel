sudo: false
os: linux
language: haskell
addons:
  apt:
    packages:
    - texlive-latex-recommended lmodern texlive-fonts-recommended texlive-latex-extra
      texlive-fonts-extra dvipng texlive-latex-recommended texlive-lang-french
before_install:
- sudo add-apt-repository -y ppa:jonathonf/python-2.7
- sudo apt-get update
- sudo apt-get install python2.7  librsvg2-bin
install:
- wget https://github.com/jgm/pandoc/releases/download/2.0.6/pandoc-2.0.6-1-amd64.deb
- sudo dpkg -i pandoc-2.0.6-1-amd64.deb
- wget https://github.com/lierdakil/pandoc-crossref/releases/download/v0.3.0.1/linux-ghc80-pandoc20.tar.gz
- mkdir pandoc-crossref
- cd pandoc-crossref
- mv ../linux-ghc80-pandoc20.tar.gz .
- tar xzvf linux-ghc80-pandoc20.tar.gz
- cd ..
- export PATH=`pwd`/pandoc-crossref:$PATH
- sudo -H pip install --upgrade pip
- sudo -H pip install -U pandoc-numbering
cache:
- pip
script:
- make
after_deploy: |
  git config --global user.email "travis@travis-ci.org"
  git config --global user.name "Travis CI"
  cd "$TRAVIS_BUILD_DIR"
  git clone https://${GH_TOKEN}@github.com/mathintro/mathintro.github.io.git
  cd mathintro.github.io
  # This generates a `web` directory containing the website.
  cp ../cours.html deuxieme_logiciel/index.html
  git add deuxieme_logiciel/index.html
  git commit --message "Travis build: $TRAVIS_BUILD_NUMBER"
  # Make sure to make the output quiet, or else the API token will leak!
  # This works because the API key can replace your password.
  git push --quiet https://${GH_TOKEN}@github.com/mathintro/mathintro.github.io.git
env:
  global:
  - secure: WCpzak+YK2v3+X1Nn3SyViTgTqqfLtOkFPMcssrMltYDcEWbSQ0EL60BUict9wzw+L+i0nUc1Wo6Buf/bgKu6cintIjBlpdnk+v1/qOxRFCQQeVOA/966qS7EERiC8XI62/2ctjfH9e3BoDv/U6X7n8BNa1t19ZUGR4b9x0RV4o6kT0/iH3wwglY+Pt7lT0iuvm7FEYvIjI+X7HW3mU/J7TtVXlgeTLIr+iJfRaWPYGSnbvwfPcChXa86mglXLovDUBEPdCg6ZF1/8qIU45wDShmHKRacESRVIJ1S7wSFbNWCqsAN3aL5sh52MzuwahLu9JphqQBdg5UrO0Oa01Y6Hm4xQ7FAdE9lVMfb161Y25N6w+yPoyPZdTIElYIX+se+AeS7IRIVRUBig9nuVYUpJrrtGk77gIZYO++uyHotGk5QRgd8Kf4Zfl5P2UlimV9cjYwIum9dGzKoeVuQi4EDtOgsJTTsNM7dwVXnUQlwpBRLTiUw+JDMOxQTBtzzTK0vRpBFJcnTLeYshv3oJiJMnvsdblqTdkJ/HZGRTvL2LOiyRlwRVQkuLpyLvmyNWmL0/yp5iADa7dtpluCu5S4UqpH4RcT1oedk0aW0cButajvTm7TpWllkDBEACmPoH1C1dtNom9hrc43ZEnmjbnH3Ij9nThWmiJDPApOTv2vjzk=
deploy:
  provider: releases
  api_key:
    secure: GfkAVe4+GYpKFpp90+K5MXqra2Tmhd9XnxG7r9WDWy6lrV+MiN3K2K4CqOFDqskRqqy5yMPJzBi2e1CWf2BvsuGSq/1kRH6V4Gbu3H7fyLRF76cQh7NnOoFO/Nz23ldp9JlckR3+79eVT4GNJ14R8DROFHsVmnBaDrdzP+fQyHiJMDcTy1jOc+fNg9ZOPM0PIFcm1gtJMo6PohERmTwH12R2NPsf1HQlzOZ/48+Lm+1xePNEqrz6xETT4Fh/h/i8Jc7JyQ1Py/KiWzCQfbq9IaMZOd+MQRREHLM7zFe0B06IvybQjkNk4cDWGbC8ZvTq7LBOmERrkGXEKGLMJg+hcsCRGy6PcdkszHIdzTtdUoyXkYMzExPRylE+p+EYK1XwY6iz+d6BJjc8T4ueeXULM7J4plvQ9Htrk2TeP1jl/e+2+bdaNhDz0JSZIBnDIXlMbVEZIokR+3gALp18ZvjryhxqiR7I3TxPQ0dTeFEbaQL1uY3nRIpnCHZTRoPEGitqxS0VMCDCqiIEzNZA2FOD2aEg4IetHKnWXP21P4zXF7ChjfPtjsZ5awucV2z7GGMHAcec+FdFyAZjq5TWGHMmosiLb3pDMpCvW10ohd8TGUIIvG6MJtmLOdVFviWbmQN2W7uby/r2z9Euv5F4xIiMXRsa6f2hIm0joaK1m6UBIxk=
  file: 
    - cours.pdf
    - cours.html
  skip_cleanup: true
  on:
    repo: mathintro/deuxieme_logiciel
    tags: true
    all_branches: true
